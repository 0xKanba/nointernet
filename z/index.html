<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>تطبيق الصور الرياضية</title>
    <link rel="stylesheet" href="styles.css">
    <link rel="manifest" href="manifest.json">
    <meta name="theme-color" content="#1a73e8">
    <!-- إضافة رؤوس مهمة -->
    <meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate">
    <meta http-equiv="Pragma" content="no-cache">
    <meta http-equiv="Expires" content="0">
</head>
<body>
    <header>
        <button id="installBtn" class="install-btn">تثبيت التطبيق</button>
    </header>
    
    <main>
        <h1>معرض الصور الرياضية</h1>
        <div class="gallery">
            <div class="image-container">
                <img src="https://images.unsplash.com/photo-1571019613454-1cb2f99b2d8b?auto=format&fit=crop&w=800&q=80" alt="كرة قدم">
                <div class="caption">كرة قدم</div>
            </div>
            <div class="image-container">
                <img src="https://images.unsplash.com/photo-1554080351-a76ca4bcf599?auto=format&fit=crop&w=800&q=80" alt="كرة سلة">
                <div class="caption">كرة سلة</div>
            </div>
            <div class="image-container">
                <img src="https://images.unsplash.com/photo-1595435934249-5c1ca5a0690c?auto=format&fit=crop&w=800&q=80" alt="سباحة">
                <div class="caption">سباحة</div>
            </div>
        </div>
    </main>

    <!-- إضافة شفرة تسجيل Service Worker مباشرة في HTML -->
    <script>
        // تسجيل Service Worker فوراً
        if ('serviceWorker' in navigator) {
            window.addEventListener('load', function() {
                navigator.serviceWorker.register('./sw.js', { scope: './' })
                    .then(function(registration) {
                        console.log('Service Worker مسجل بنجاح:', registration);
                        
                        // التحقق من التحديثات
                        registration.addEventListener('updatefound', function() {
                            const installingWorker = registration.installing;
                            installingWorker.addEventListener('statechange', function() {
                                if (installingWorker.state === 'installed' && navigator.serviceWorker.controller) {
                                    console.log('يوجد تحديث جديد');
                                    showUpdateNotification();
                                }
                            });
                        });
                    })
                    .catch(function(error) {
                        console.error('فشل تسجيل Service Worker:', error);
                    });
            });
        }
        
        function showUpdateNotification() {
            const notification = document.createElement('div');
            notification.style.cssText = `
                position: fixed;
                top: 70px;
                left: 50%;
                transform: translateX(-50%);
                background: #1a73e8;
                color: white;
                padding: 10px 20px;
                border-radius: 5px;
                z-index: 1000;
                cursor: pointer;
            `;
            notification.textContent = 'يوجد تحديث جديد. انقر للتحديث.';
            notification.onclick = () => window.location.reload();
            document.body.appendChild(notification);
        }
    </script>
    
    <script src="app.js"></script>
</body>
</html>
